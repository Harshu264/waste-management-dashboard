<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Waste Management Dashboard</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" type="image/x-icon" href="image.png">
    <!-- Custom Tailwind Configuration for Glassmorphism colors -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary-blue': '#00B0FF',
                        'secondary-green': '#00E676',
                        'bg-dark': '#0f172a',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style>
        body {
            background-color: #1e293b; /* Dark Slate Background */
            background-image: url('https://placehold.co/1920x1080/0f172a/94a3b8?text=Cityscape+Background');
            background-size: cover;
            background-position: center;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 1rem;
        }
        /* Glassmorphism card effect */
        .glass-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.18);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        }
        /* Custom gradient icon effect */
        .gradient-text {
            background-image: linear-gradient(45deg, #00B0FF, #00E676);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
    </style>
</head>
<body class="font-sans">

    <!-- Main Application Container -->
    <div id="app-container" class="glass-card w-full max-w-md p-6 sm:p-8 text-white">

        <!-- Header -->
        <header class="text-center mb-6">
            <svg class="h-16 w-16 mx-auto mb-2 gradient-text" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                <path d="M2 17l10 5 10-5M2 12l10 5 10-5"></path>
                <path d="M12 22s-8-4-8-10V5l8-4 8 4v7c0 6-8 10-8 10z"></path>
                <path d="M8 12l4-2 4 2"></path>
                <circle cx="12" cy="7" r="1.5"></circle>
            </svg>
            <h1 class="text-2xl font-bold">URBAN WASTE MANAGEMENT</h1>
            <p class="text-sm text-gray-300">MUNICIPALITY HEAD DASHBOARD</p>
        </header>

        <!-- Content Area -->
        <div id="content">
            <!-- Content will be injected here by JavaScript -->
            <p class="text-center text-gray-400">Loading...</p>
        </div>

    </div>

    <script>
        const contentDiv = document.getElementById('content');

        // --- Simulated Backend API Call ---
        // In a real application, this would be a fetch() call to the Python or C++ server.
        const mockFetchData = () => new Promise(resolve => {
            setTimeout(() => {
                resolve({
                    dustbinId: 'A4',
                    location: 'Corner of Main St & Oak Ave',
                    capacity: 89,
                    type: 'Mixed Waste',
                    lastEmptied: '8 days ago',
                    isCritical: true,
                });
            }, 500); // Simulate network delay
        });


        // --- UI Rendering Functions ---

        /** Renders the main dashboard UI */
        async function renderDashboard() {
            try {
                // 1. Fetch data (simulated)
                const data = await mockFetchData();

                // Determine capacity color
                const capacityColor = data.capacity > 85 ? 'text-red-400' : data.capacity > 60 ? 'text-yellow-400' : 'text-secondary-green';
                const capacityStatus = data.isCritical ? ' (Critical)' : '';

                // 2. Build HTML
                contentDiv.innerHTML = `
                    <!-- Urgent Alert -->
                    <div class="p-4 mb-6 rounded-xl border border-red-400 bg-red-800/20 flex items-center shadow-lg">
                        <svg class="w-6 h-6 text-red-400 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>
                        <div>
                            <p class="font-bold text-red-300">URGENT: ${data.capacity}% FULL.</p>
                            <p class="text-sm text-red-300">REQUEST COLLECTION.</p>
                        </div>
                    </div>

                    <!-- Dustbin Details Card -->
                    <div class="bg-white/10 p-5 rounded-xl mb-6">
                        <h2 class="text-xl font-semibold mb-4 border-b border-white/20 pb-2">DUSTBIN #${data.dustbinId} DETAILS</h2>

                        <div class="flex flex-col md:flex-row gap-4">
                            <!-- Details Text -->
                            <div class="flex-grow text-sm space-y-2">
                                <p><span class="font-medium">Location:</span> ${data.location}</p>
                                <p><span class="font-medium">Capacity:</span> <span class="${capacityColor} font-bold">${data.capacity}%</span>${capacityStatus}</p>
                                <p><span class="font-medium">Type:</span> ${data.type}</p>
                                <p><span class="font-medium">Last Emptied:</span> ${data.lastEmptied}</p>
                            </div>
                            <!-- Image (Placeholder) -->
                            <div class="flex-shrink-0">
                                <img src="bin.png" 
                                     onerror="this.src='https://placehold.co/120x120/475569/ffffff?text=Image+Unavailable'" 
                                     alt="Dustbin Photo" 
                                     class="rounded-lg w-full md:w-32 h-32 object-cover border border-white/20 shadow-md">
                            </div>
                        </div>

                        <button onclick="requestCollection()" class="mt-5 w-full py-3 rounded-xl font-bold transition duration-300 shadow-xl"
                                style="background: linear-gradient(90deg, #00B0FF, #00E676);">
                            REQUEST IMMEDIATE COLLECTION
                        </button>
                    </div>

                    <button onclick="viewHistory()" class="w-full text-center text-sm text-gray-300 hover:text-white transition duration-200 py-2">
                        View History
                    </button>
                `;

            } catch (error) {
                console.error('Error fetching dashboard data:', error);
                contentDiv.innerHTML = '<p class="text-center text-red-400">Error loading dashboard. Please try again.</p>';
            }
        }

        /** Placeholder functions for button actions */
        function requestCollection() {
            alertMessage('Collection Request Sent!', 'The collection request for Dustbin A4 has been successfully logged and prioritized.', 'primary-blue');
        }

        function viewHistory() {
            alertMessage('Feature Not Implemented', 'This would navigate to the detailed history view.', 'secondary-green');
        }

        function alertMessage(title, message, color) {
            // Simple custom modal/alert simulation
            const modal = document.createElement('div');
            modal.innerHTML = `
                <div class="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4">
                    <div class="bg-slate-700/90 glass-card p-6 rounded-xl max-w-sm w-full text-white shadow-2xl">
                        <h3 class="text-lg font-bold mb-2" style="color: ${color};">${title}</h3>
                        <p class="text-sm text-gray-300 mb-4">${message}</p>
                        <button class="w-full py-2 rounded-lg font-semibold bg-gray-500 hover:bg-gray-600 transition" onclick="this.parentElement.parentElement.remove()">
                            Close
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Initialize the dashboard view on load
        document.addEventListener('DOMContentLoaded', renderDashboard);

    </script>

</body>
</html>
